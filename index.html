<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ohm-Vengers: La Resistencia del Conocimiento</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #7e22ce 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 25px;
            box-shadow: 0 25px 70px rgba(0,0,0,0.4);
            max-width: 1000px;
            width: 100%;
            padding: 50px;
            position: relative;
            overflow: hidden;
        }

        .container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 8px;
            background: linear-gradient(90deg, #ff6b6b, #feca57, #48dbfb, #ff9ff3);
        }

        /* PANTALLA DE INICIO */
        #pantalla-inicio {
            text-align: center;
        }

        .logo-container {
            margin-bottom: 30px;
        }

        h1 {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: 3.5em;
            margin-bottom: 10px;
            font-weight: 900;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            letter-spacing: 2px;
        }

        .subtitulo {
            font-size: 1.8em;
            color: #764ba2;
            font-weight: bold;
            margin-bottom: 30px;
            text-transform: uppercase;
            letter-spacing: 3px;
        }

        .mision-principal {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            border-radius: 20px;
            margin: 40px 0;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }

        .mision-principal h2 {
            font-size: 2em;
            margin-bottom: 20px;
            text-transform: uppercase;
        }

        .mision-principal p {
            font-size: 1.2em;
            line-height: 1.8;
            margin-bottom: 15px;
        }

        .modulos-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin: 40px 0;
        }

        .modulo-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            text-align: center;
        }

        .modulo-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 40px rgba(245, 87, 108, 0.4);
        }

        .modulo-card h3 {
            font-size: 1.5em;
            margin-bottom: 15px;
        }

        .modulo-card p {
            font-size: 1em;
            line-height: 1.6;
        }

        .modulo-card.lab {
            background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%);
        }

        .modulo-card.simulador {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
        }

        .modulo-card.casos {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
        }

        .modulo-card.desafios {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
        }

        .modulo-card.certificacion {
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            position: relative;
        }

        .modulo-card.certificacion.bloqueado {
            background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
            cursor: not-allowed;
            opacity: 0.7;
        }

        .modulo-card.certificacion.bloqueado:hover {
            transform: none;
            box-shadow: none;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 18px 45px;
            font-size: 1.3em;
            border-radius: 12px;
            cursor: pointer;
            margin: 15px;
            transition: transform 0.2s, box-shadow 0.2s;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(102, 126, 234, 0.5);
        }

        button:active {
            transform: translateY(-1px);
        }

        button.secondary {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        /* PANTALLA DE INSTRUCCIONES */
        #pantalla-instrucciones {
            display: none;
        }

        .instruccion-hero {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 30px;
            text-align: center;
        }

        .instruccion-hero h2 {
            font-size: 2.5em;
            margin-bottom: 15px;
        }

        .instruccion-item {
            background: #f0f4ff;
            padding: 25px;
            margin: 20px 0;
            border-radius: 12px;
            border-left: 6px solid #667eea;
        }

        .instruccion-item h3 {
            color: #764ba2;
            margin-bottom: 15px;
            font-size: 1.4em;
        }

        .formula-box {
            background: white;
            padding: 20px;
            border-radius: 10px;
            font-size: 2em;
            text-align: center;
            margin: 25px 0;
            border: 3px dashed #667eea;
            font-weight: bold;
            color: #667eea;
        }

        /* PANTALLA DE JUEGO */
        #pantalla-juego {
            display: none;
        }

        .header-juego {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            text-align: center;
        }

        .header-juego h2 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .progreso {
            background: rgba(255,255,255,0.2);
            padding: 10px;
            border-radius: 8px;
            font-size: 1.2em;
            font-weight: bold;
        }

        .objetivo-box {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
            font-size: 1.4em;
            text-align: center;
            font-weight: bold;
            box-shadow: 0 8px 20px rgba(245, 87, 108, 0.4);
        }

        .descripcion-mision {
            background: #fff3cd;
            padding: 20px;
            border-radius: 12px;
            margin: 25px 0;
            border-left: 6px solid #ffc107;
        }

        .descripcion-mision strong {
            color: #856404;
            font-size: 1.1em;
        }

        /* Circuito Visual Mejorado */
        .circuito-visual {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 40px;
            border-radius: 20px;
            margin: 30px 0;
            text-align: center;
            position: relative;
            min-height: 280px;
            border: 3px solid #dee2e6;
        }

        .componente {
            display: inline-block;
            margin: 15px 25px;
            position: relative;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }

        .componente-icono {
            font-size: 5em;
            margin-bottom: 10px;
            filter: drop-shadow(3px 3px 5px rgba(0,0,0,0.2));
        }

        .componente-etiqueta {
            font-weight: bold;
            color: #495057;
            font-size: 1.2em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .componente-valor {
            color: #667eea;
            font-size: 1.5em;
            font-weight: bold;
            margin-top: 8px;
            padding: 5px 15px;
            background: white;
            border-radius: 8px;
            display: inline-block;
        }

        .cable {
            display: inline-block;
            width: 90px;
            height: 6px;
            background: linear-gradient(90deg, #495057 0%, #6c757d 100%);
            vertical-align: middle;
            position: relative;
            top: -45px;
            border-radius: 3px;
        }

        .lectura-corriente {
            background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%);
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
            text-align: center;
            box-shadow: 0 8px 20px rgba(132, 250, 176, 0.3);
        }

        .lectura-corriente h3 {
            color: #1e7e34;
            margin-bottom: 12px;
            font-size: 1.3em;
        }

        .lectura-valor {
            font-size: 3em;
            font-weight: bold;
            color: #155724;
        }

        /* Controles Mejorados */
        .controles {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            margin: 25px 0;
            border: 2px solid #dee2e6;
        }

        .control-item {
            margin: 25px 0;
        }

        .control-item label {
            display: block;
            font-weight: bold;
            margin-bottom: 12px;
            color: #495057;
            font-size: 1.2em;
        }

        input[type="range"] {
            width: 100%;
            height: 10px;
            border-radius: 5px;
            background: #dee2e6;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            cursor: pointer;
            box-shadow: 0 3px 10px rgba(102, 126, 234, 0.5);
        }

        input[type="range"]::-moz-range-thumb {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            cursor: pointer;
            border: none;
            box-shadow: 0 3px 10px rgba(102, 126, 234, 0.5);
        }

        .valor-actual {
            display: inline-block;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 8px 20px;
            border-radius: 25px;
            font-weight: bold;
            margin-left: 12px;
            font-size: 1.1em;
        }

        .opciones-multiples {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            margin: 25px 0;
        }

        .opcion-btn {
            background: white;
            border: 4px solid #667eea;
            color: #667eea;
            padding: 25px 35px;
            margin: 12px;
            font-size: 1.3em;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            min-width: 160px;
            font-weight: bold;
        }

        .opcion-btn:hover {
            background: #667eea;
            color: white;
            transform: scale(1.05);
        }

        .opcion-btn.correcta {
            background: #28a745;
            border-color: #28a745;
            color: white;
        }

        .opcion-btn.incorrecta {
            background: #dc3545;
            border-color: #dc3545;
            color: white;
        }

        /* Modal de Resultado */
        .resultado-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .resultado-contenido {
            background: white;
            padding: 50px;
            border-radius: 25px;
            max-width: 650px;
            width: 90%;
            text-align: center;
            animation: aparecer 0.4s ease-out;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
        }

        @keyframes aparecer {
            from {
                transform: scale(0.5) rotate(-5deg);
                opacity: 0;
            }
            to {
                transform: scale(1) rotate(0deg);
                opacity: 1;
            }
        }

        .resultado-icono {
            font-size: 6em;
            margin-bottom: 25px;
        }

        .resultado-titulo {
            font-size: 2.5em;
            margin-bottom: 25px;
            font-weight: bold;
        }

        .resultado-titulo.exito {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .resultado-titulo.error {
            background: linear-gradient(135deg, #dc3545 0%, #fd7e14 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .resultado-explicacion {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 12px;
            margin: 25px 0;
            line-height: 1.9;
            text-align: left;
        }

        /* Pantalla Final */
        #pantalla-final {
            display: none;
            text-align: center;
        }

        .victoria-hero {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            padding: 50px;
            border-radius: 25px;
            margin-bottom: 40px;
        }

        .victoria-hero h1 {
            -webkit-text-fill-color: white;
            font-size: 3em;
            margin-bottom: 20px;
        }

        .estadisticas {
            background: #f8f9fa;
            padding: 40px;
            border-radius: 20px;
            margin: 40px 0;
            border: 3px solid #dee2e6;
        }

        .estadistica-item {
            font-size: 1.6em;
            margin: 20px 0;
            color: #495057;
        }

        .estadistica-item strong {
            color: #667eea;
            font-size: 1.2em;
        }

        .oculto {
            display: none;
        }

        /* CASOS REALES */
        .caso-contenedor {
            background: #f8f9fa;
            padding: 35px;
            border-radius: 20px;
            margin: 25px 0;
        }

        .caso-historia {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            color: #333;
        }

        .caso-historia h3 {
            color: #d35400;
            font-size: 1.8em;
            margin-bottom: 20px;
        }

        .caso-historia p {
            font-size: 1.2em;
            line-height: 1.9;
            margin-bottom: 15px;
        }

        .caso-pregunta {
            background: white;
            padding: 25px;
            border-radius: 12px;
            margin: 25px 0;
            border-left: 6px solid #667eea;
        }

        .caso-pregunta h4 {
            color: #667eea;
            font-size: 1.4em;
            margin-bottom: 15px;
        }

        .caso-input-group {
            display: flex;
            align-items: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .caso-input-group label {
            font-size: 1.2em;
            font-weight: bold;
            color: #495057;
        }

        .caso-input-group input[type="number"] {
            padding: 12px 20px;
            font-size: 1.2em;
            border: 3px solid #667eea;
            border-radius: 10px;
            width: 150px;
            text-align: center;
            font-weight: bold;
        }

        .caso-input-group input[type="number"]:focus {
            outline: none;
            border-color: #764ba2;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.3);
        }

        .caso-unidad {
            font-size: 1.2em;
            font-weight: bold;
            color: #667eea;
        }

        .caso-resultado {
            background: #f0f4ff;
            padding: 25px;
            border-radius: 12px;
            margin: 25px 0;
            display: none;
        }

        .caso-resultado.correcto {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            border-left: 6px solid #28a745;
        }

        .caso-resultado.incorrecto {
            background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);
            border-left: 6px solid #dc3545;
        }

        .caso-resultado h4 {
            font-size: 1.5em;
            margin-bottom: 15px;
        }

        .caso-resultado.correcto h4 {
            color: #28a745;
        }

        .caso-resultado.incorrecto h4 {
            color: #dc3545;
        }

        .caso-explicacion {
            font-size: 1.1em;
            line-height: 1.8;
            color: #333;
        }

        .caso-calculo {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 1.1em;
        }

        .caso-botones {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 25px;
        }

        /* DESAF√çOS */
        .cronometro {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 1.2em;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.3);
        }

        .cronometro.advertencia {
            animation: pulsar 1s infinite;
        }

        @keyframes pulsar {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .puntos-desafio {
            background: linear-gradient(135deg, #feca57 0%, #ff9ff3 100%);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 1.2em;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(254, 202, 87, 0.3);
        }

        .desafio-contenedor {
            background: #f8f9fa;
            padding: 35px;
            border-radius: 20px;
            margin: 25px 0;
        }

        .desafio-pregunta {
            background: white;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 25px;
            border-left: 6px solid #667eea;
        }

        .desafio-pregunta h3 {
            color: #667eea;
            font-size: 1.6em;
            margin-bottom: 20px;
        }

        .desafio-pregunta p {
            font-size: 1.2em;
            line-height: 1.8;
            color: #333;
        }

        .desafio-opciones {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 25px 0;
        }

        .desafio-opcion {
            background: white;
            border: 3px solid #667eea;
            color: #667eea;
            padding: 20px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1.1em;
            font-weight: bold;
            text-align: center;
        }

        .desafio-opcion:hover {
            background: #667eea;
            color: white;
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        }

        .desafio-opcion.seleccionada {
            background: #667eea;
            color: white;
        }

        .desafio-opcion.correcta {
            background: #28a745;
            border-color: #28a745;
            color: white;
        }

        .desafio-opcion.incorrecta {
            background: #dc3545;
            border-color: #dc3545;
            color: white;
        }

        .desafio-input {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin: 25px 0;
            flex-wrap: wrap;
        }

        .desafio-input input[type="number"] {
            padding: 15px 25px;
            font-size: 1.3em;
            border: 3px solid #667eea;
            border-radius: 12px;
            width: 180px;
            text-align: center;
            font-weight: bold;
        }

        .desafio-input input[type="number"]:focus {
            outline: none;
            border-color: #764ba2;
            box-shadow: 0 0 15px rgba(102, 126, 234, 0.4);
        }

        .desafio-feedback {
            background: #f0f4ff;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            display: none;
        }

        .desafio-feedback.correcto {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            border-left: 6px solid #28a745;
        }

        .desafio-feedback.incorrecto {
            background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);
            border-left: 6px solid #dc3545;
        }

        .desafio-feedback h4 {
            font-size: 1.3em;
            margin-bottom: 10px;
        }

        .desafio-feedback.correcto h4 {
            color: #28a745;
        }

        .desafio-feedback.incorrecto h4 {
            color: #dc3545;
        }

        /* CERTIFICACI√ìN */
        .certificado {
            background: white;
            border: 10px solid;
            border-image: linear-gradient(135deg, #ffd700 0%, #ffed4e 50%, #ffd700 100%) 1;
            padding: 50px;
            border-radius: 15px;
            margin: 30px auto;
            max-width: 800px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            text-align: center;
            position: relative;
        }

        .certificado::before {
            content: 'üèÜ';
            font-size: 4em;
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: white;
            padding: 0 20px;
        }

        .certificado-titulo {
            font-size: 2.5em;
            color: #333;
            margin-bottom: 20px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .certificado-subtitulo {
            font-size: 1.3em;
            color: #666;
            margin-bottom: 30px;
        }

        .certificado-nombre {
            font-size: 2em;
            color: #667eea;
            font-weight: bold;
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .certificado-nivel {
            font-size: 3em;
            font-weight: bold;
            margin: 30px 0;
            padding: 25px;
            border-radius: 15px;
            color: white;
        }

        .certificado-nivel.maestro {
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            color: #333;
        }

        .certificado-nivel.experto {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .certificado-nivel.avanzado {
            background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%);
            color: #333;
        }

        .certificado-nivel.formacion {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            color: #333;
        }

        .certificado-nivel.aprendiz {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            color: #333;
        }

        .certificado-estadisticas {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .certificado-stat {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid #667eea;
        }

        .certificado-stat-valor {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .certificado-stat-label {
            color: #666;
            font-size: 0.9em;
        }

        .certificado-fecha {
            margin-top: 30px;
            color: #666;
            font-style: italic;
        }

        .certificado-firma {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 2px solid #dee2e6;
        }

        .certificado-firma strong {
            color: #667eea;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 25px;
            }

            h1 {
                font-size: 2.2em;
            }

            .subtitulo {
                font-size: 1.2em;
            }

            .modulos-grid {
                grid-template-columns: 1fr;
            }

            .circuito-visual {
                padding: 20px;
            }

            .componente-icono {
                font-size: 3em;
            }

            .cable {
                width: 50px;
            }

            button {
                padding: 15px 30px;
                font-size: 1.1em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- PANTALLA DE INICIO -->
        <div id="pantalla-inicio">
            <div class="logo-container">
                <h1>‚ö° OHM-VENGERS ‚ö°</h1>
                <p class="subtitulo">La Resistencia del Conocimiento</p>
            </div>
            
            <div class="mision-principal">
                <h2>ü¶∏‚Äç‚ôÇÔ∏è ¬øTIENES LO NECESARIO PARA SER UN OHM-VENGER?</h2>
                <p>Una crisis el√©ctrica amenaza a toda la ciudad. Los circuitos est√°n fallando y miles de personas est√°n en riesgo. Necesitamos h√©roes que dominen la <strong>Ley de Ohm</strong> para restaurar el orden.</p>
                <p>√önete a la misi√≥n de rescate y convi√©rtete en un especialista en electricidad. <strong>Tu conocimiento puede salvar vidas.</strong></p>
            </div>

            <div class="modulos-grid">
                <div class="modulo-card lab" onclick="juego.mostrarInstrucciones()">
                    <h3>‚öóÔ∏è Ley de Ohm</h3>
                    <p>Domina la f√≥rmula fundamental: V = I √ó R</p>
                </div>
                
                <div class="modulo-card simulador" onclick="juego.iniciarJuego()">
                    <h3>üî¨ Simulaciones</h3>
                    <p>Experimenta con circuitos interactivos reales</p>
                </div>
                
                <div class="modulo-card casos" onclick="juego.mostrarCasosReales()">
                    <h3>üåç Casos Reales</h3>
                    <p>Resuelve problemas del mundo real</p>
                </div>
                
                <div class="modulo-card desafios" onclick="juego.mostrarDesafios()">
                    <h3>üèÜ Desaf√≠os</h3>
                    <p>Pruebas de ingenier√≠a definitivas</p>
                </div>

                <div class="modulo-card certificacion" id="modulo-certificacion" onclick="juego.mostrarCertificacion()">
                    <h3>üéì Certificaci√≥n</h3>
                    <p>Obt√©n tu certificado Ohm-Venger</p>
                    <div id="badge-bloqueado" style="margin-top: 10px; font-size: 0.9em; color: rgba(255,255,255,0.7);">
                        üîí Completa todos los m√≥dulos
                    </div>
                </div>
            </div>

            <div style="margin-top: 40px;">
                <button onclick="juego.iniciarJuego()">üéÆ INICIAR MISI√ìN</button>
                <button class="secondary" onclick="juego.mostrarInstrucciones()">üìñ ENTRENAMIENTO</button>
            </div>
        </div>

        <!-- PANTALLA DE INSTRUCCIONES -->
        <div id="pantalla-instrucciones">
            <div class="instruccion-hero">
                <h2>üìö ENTRENAMIENTO OHM-VENGER</h2>
                <p>Prep√°rate para la misi√≥n dominando estos conceptos</p>
            </div>
            
            <div class="instruccion-item">
                <h3>üéØ Tu Misi√≥n</h3>
                <p>Como Ohm-Venger, deber√°s estabilizar circuitos el√©ctricos ajustando voltajes y resistencias. Tu objetivo es lograr corrientes el√©ctricas espec√≠ficas que mantengan los equipos funcionando de forma segura.</p>
            </div>

            <div class="instruccion-item">
                <h3>‚ö° La Ley de Ohm - Tu Arma Secreta</h3>
                <p>Esta es la f√≥rmula que usar√°s en cada misi√≥n:</p>
                <div class="formula-box">I = V / R</div>
                <p><strong>Donde:</strong></p>
                <ul style="text-align: left; margin-left: 40px; line-height: 2.2; font-size: 1.1em;">
                    <li><strong>I (Corriente)</strong> = Se mide en Amperios (A)</li>
                    <li><strong>V (Voltaje)</strong> = Se mide en Voltios (V)</li>
                    <li><strong>R (Resistencia)</strong> = Se mide en Ohmios (Œ©)</li>
                </ul>
                <p style="margin-top: 20px;"><strong>üí° Recuerda:</strong> Al aumentar la resistencia, la corriente disminuye. Al aumentar el voltaje, la corriente aumenta.</p>
            </div>

            <div class="instruccion-item">
                <h3>üéÆ Mec√°nicas de Juego</h3>
                <p><strong>1.</strong> Lee el objetivo de corriente que debes alcanzar en cada misi√≥n</p>
                <p><strong>2.</strong> Ajusta los controles de Voltaje (V) y Resistencia (R) usando los deslizadores</p>
                <p><strong>3.</strong> Observa en tiempo real c√≥mo cambia la corriente (I)</p>
                <p><strong>4.</strong> Cuando logres la corriente objetivo, presiona "Comprobar"</p>
                <p><strong>5.</strong> Completa las 5 misiones para convertirte en Ohm-Venger oficial</p>
            </div>

            <div style="text-align: center; margin-top: 40px;">
                <button onclick="juego.iniciarJuego()">üöÄ ¬°ESTOY LISTO!</button>
                <button class="secondary" onclick="juego.volverInicio()">üè† Men√∫ Principal</button>
            </div>
        </div>

        <!-- PANTALLA DE JUEGO -->
        <div id="pantalla-juego">
            <div class="header-juego">
                <h2 id="titulo-mision">Misi√≥n 1: Iniciaci√≥n</h2>
                <div class="progreso" id="progreso">Misi√≥n 1 de 5</div>
            </div>

            <div class="objetivo-box" id="objetivo-box">
                üéØ OBJETIVO: Lograr una corriente de <span id="objetivo-corriente">0.5</span> A
            </div>

            <div id="descripcion-reto" class="descripcion-mision">
                <strong>üìã Briefing de la Misi√≥n:</strong>
                <p id="texto-descripcion-reto"></p>
            </div>

            <!-- Circuito Visual -->
            <div class="circuito-visual">
                <div class="componente">
                    <div class="componente-icono">üîã</div>
                    <div class="componente-etiqueta">Fuente</div>
                    <div class="componente-valor" id="display-voltaje">12 V</div>
                </div>
                
                <div class="cable"></div>
                
                <div class="componente">
                    <div class="componente-icono">üìä</div>
                    <div class="componente-etiqueta">Resistencia</div>
                    <div class="componente-valor" id="display-resistencia">100 Œ©</div>
                </div>
                
                <div class="cable"></div>
                
                <div class="componente">
                    <div class="componente-icono">‚ö°</div>
                    <div class="componente-etiqueta">Amper√≠metro</div>
                </div>
            </div>

            <!-- Lectura de Corriente -->
            <div class="lectura-corriente">
                <h3>üìä CORRIENTE MEDIDA</h3>
                <div class="lectura-valor" id="lectura-corriente">0.00 A</div>
            </div>

            <!-- Controles -->
            <div class="controles" id="controles-normales">
                <div class="control-item" id="control-voltaje">
                    <label>
                        üîã Voltaje (V): 
                        <span class="valor-actual" id="valor-voltaje">12 V</span>
                    </label>
                    <input type="range" id="slider-voltaje" min="1" max="24" value="12" step="0.5">
                </div>

                <div class="control-item" id="control-resistencia">
                    <label>
                        üìä Resistencia (Œ©): 
                        <span class="valor-actual" id="valor-resistencia">100 Œ©</span>
                    </label>
                    <input type="range" id="slider-resistencia" min="10" max="500" value="100" step="5">
                </div>
            </div>

            <!-- Opciones m√∫ltiples -->
            <div id="opciones-multiples" class="opciones-multiples oculto">
                <p style="width: 100%; text-align: center; font-size: 1.3em; margin-bottom: 25px;">
                    <strong>Selecciona la resistencia correcta:</strong>
                </p>
            </div>

            <div style="text-align: center; margin-top: 35px;">
                <button onclick="juego.comprobarRespuesta()">‚úÖ COMPROBAR MISI√ìN</button>
                <button class="secondary" onclick="juego.reiniciarReto()">üîÑ Reintentar</button>
                <button class="secondary" onclick="juego.volverInicio()">üè† Men√∫ Principal</button>
            </div>
        </div>

        <!-- MODAL DE RESULTADO -->
        <div id="resultado-modal" class="resultado-modal">
            <div class="resultado-contenido">
                <div class="resultado-icono" id="resultado-icono">‚úÖ</div>
                <div class="resultado-titulo" id="resultado-titulo">¬°Misi√≥n Cumplida!</div>
                <div class="resultado-explicacion" id="resultado-explicacion"></div>
                <button onclick="juego.siguienteReto()">‚û°Ô∏è Siguiente Misi√≥n</button>
            </div>
        </div>

        <!-- PANTALLA DE CASOS REALES -->
        <div id="pantalla-casos-reales" style="display: none;">
            <div class="header-juego">
                <h2>üåç CASOS REALES DE PITALITO</h2>
                <div class="progreso" id="progreso-casos">Caso 1 de 5</div>
            </div>

            <div class="caso-contenedor" id="caso-contenedor">
                <!-- El caso se cargar√° din√°micamente aqu√≠ -->
            </div>

            <div style="text-align: center; margin-top: 35px;">
                <button class="secondary" onclick="juego.volverInicio()">üè† Men√∫ Principal</button>
            </div>
        </div>

        <!-- PANTALLA DE DESAF√çOS -->
        <div id="pantalla-desafios" style="display: none;">
            <div class="header-juego">
                <h2>üèÜ DESAF√çO OHM-VENGER</h2>
                <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 15px;">
                    <div class="progreso" id="progreso-desafios">Pregunta 1 de 10</div>
                    <div class="cronometro" id="cronometro">‚è±Ô∏è 3:00</div>
                    <div class="puntos-desafio" id="puntos-desafio">‚≠ê 0 puntos</div>
                </div>
            </div>

            <div class="desafio-contenedor" id="desafio-contenedor">
                <!-- La pregunta se cargar√° din√°micamente aqu√≠ -->
            </div>

            <div style="text-align: center; margin-top: 35px;">
                <button class="secondary" onclick="juego.volverInicio()">üè† Men√∫ Principal</button>
            </div>
        </div>

        <!-- PANTALLA DE CERTIFICACI√ìN -->
        <div id="pantalla-certificacion" style="display: none;">
            <div class="header-juego" style="background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%); color: #333;">
                <h2>üéì CERTIFICACI√ìN OHM-VENGER</h2>
            </div>

            <div id="certificacion-contenedor" style="padding: 20px;">
                <!-- El certificado se cargar√° din√°micamente aqu√≠ -->
            </div>

            <div style="text-align: center; margin-top: 35px;">
                <button class="secondary" onclick="juego.volverInicio()">üè† Men√∫ Principal</button>
            </div>
        </div>

        <!-- PANTALLA FINAL -->
        <div id="pantalla-final">
            <div class="victoria-hero">
                <h1>üèÜ ¬°BIENVENIDO AL EQUIPO! üèÜ</h1>
                <h2 style="font-size: 2em; margin-top: 20px;">ERES OFICIALMENTE UN OHM-VENGER</h2>
                <p style="font-size: 1.3em; margin-top: 20px;">Has demostrado dominio total de la Ley de Ohm y has salvado innumerables vidas. La ciudad est√° en deuda contigo.</p>
            </div>

            <div class="estadisticas">
                <h2 style="color: #667eea; font-size: 2em; margin-bottom: 30px;">üìä ESTAD√çSTICAS DE MISI√ìN</h2>
                <div class="estadistica-item">
                    Misiones completadas: <strong id="retos-completados">5 de 5</strong>
                </div>
                <div class="estadistica-item">
                    √âxitos al primer intento: <strong id="aciertos-primer-intento">0</strong>
                </div>
                <div class="estadistica-item">
                    Intentos totales: <strong id="intentos-totales">0</strong>
                </div>
                <div class="estadistica-item" id="mensaje-final" style="color: #667eea; font-size: 1.4em; margin-top: 35px; font-weight: bold;">
                    ¬°Sigue practicando para perfeccionar tus habilidades!
                </div>
            </div>

            <button onclick="location.reload()">üîÑ Nueva Misi√≥n</button>
            <button class="secondary" onclick="juego.volverInicio()">üè† Men√∫ Principal</button>
        </div>
    </div>

    <script>
        /*
         * OHM-VENGERS: LA RESISTENCIA DEL CONOCIMIENTO
         * Juego educativo h√≠brido que combina:
         * - Narrativa de superh√©roes (Ohm-Vengers original)
         * - Mec√°nicas ABJ (Circuito al L√≠mite)
         * Autor: Carlos - I.E.T.I. Nuestra Se√±ora del Rosario, Pitalito
         */

        const juego = {
            retoActual: 0,
            intentosReto: 0,
            aciertosPrimerIntento: 0,
            intentosTotales: 0,
            respuestaSeleccionada: null,

            // CASOS REALES
            casoActual: 0,
            respuestasCasosCorrectas: 0,

            // DESAF√çOS
            desafioActual: 0,
            puntosDesafio: 0,
            tiempoRestante: 180, // 3 minutos en segundos
            temporizadorDesafio: null,
            preguntasDesafio: [],
            respuestasDesafio: [],

            // CERTIFICACI√ìN - Seguimiento de progreso
            modulosCompletados: {
                simulaciones: false,
                casosReales: false,
                desafios: false
            },
            resultadosGlobales: {
                simulaciones: { completadas: 0, total: 5, aciertosDirectos: 0 },
                casosReales: { correctas: 0, total: 5 },
                desafios: { puntos: 0, maximo: 100 }
            },

            bancoPreguntas: [
                // TIPO: C√°lculo directo (calcular R)
                {
                    tipo: 'calculo',
                    pregunta: 'Un circuito tiene un voltaje de 15V y una corriente de 0.3A. ¬øCu√°l es su resistencia?',
                    respuestaCorrecta: 50,
                    unidad: 'Œ©',
                    margenError: 1,
                    formula: 'R = V / I = 15 / 0.3'
                },
                {
                    tipo: 'calculo',
                    pregunta: 'Si tenemos 24V y 0.5A, ¬øcu√°l es la resistencia del circuito?',
                    respuestaCorrecta: 48,
                    unidad: 'Œ©',
                    margenError: 1,
                    formula: 'R = V / I = 24 / 0.5'
                },
                // TIPO: C√°lculo directo (calcular I)
                {
                    tipo: 'calculo',
                    pregunta: 'Un circuito con 12V y 60Œ©. ¬øQu√© corriente circula?',
                    respuestaCorrecta: 0.2,
                    unidad: 'A',
                    margenError: 0.02,
                    formula: 'I = V / R = 12 / 60'
                },
                {
                    tipo: 'calculo',
                    pregunta: 'Calcula la corriente en un circuito de 20V con resistencia de 40Œ©.',
                    respuestaCorrecta: 0.5,
                    unidad: 'A',
                    margenError: 0.02,
                    formula: 'I = V / R = 20 / 40'
                },
                // TIPO: C√°lculo directo (calcular V)
                {
                    tipo: 'calculo',
                    pregunta: 'Si circulan 2A a trav√©s de una resistencia de 25Œ©, ¬øcu√°l es el voltaje?',
                    respuestaCorrecta: 50,
                    unidad: 'V',
                    margenError: 1,
                    formula: 'V = I √ó R = 2 √ó 25'
                },
                {
                    tipo: 'calculo',
                    pregunta: '0.8A pasan por 30Œ©. ¬øCu√°l es el voltaje aplicado?',
                    respuestaCorrecta: 24,
                    unidad: 'V',
                    margenError: 1,
                    formula: 'V = I √ó R = 0.8 √ó 30'
                },
                // TIPO: Selecci√≥n m√∫ltiple
                {
                    tipo: 'multiple',
                    pregunta: 'Un LED necesita 20mA (0.02A) y tiene 200Œ©. ¬øQu√© voltaje necesita?',
                    opciones: ['2V', '4V', '10V', '20V'],
                    respuestaCorrecta: 1, // √≠ndice de '4V'
                    explicacion: 'V = I √ó R = 0.02 √ó 200 = 4V'
                },
                {
                    tipo: 'multiple',
                    pregunta: '¬øQu√© pasa con la corriente si duplicamos la resistencia y mantenemos el voltaje?',
                    opciones: ['Se duplica', 'Se reduce a la mitad', 'No cambia', 'Se cuadruplica'],
                    respuestaCorrecta: 1,
                    explicacion: 'I = V/R. Si R se duplica, I se divide entre 2'
                },
                {
                    tipo: 'multiple',
                    pregunta: 'Un circuito de 110V con 22Œ© consume:',
                    opciones: ['2A', '3A', '5A', '10A'],
                    respuestaCorrecta: 2, // 5A
                    explicacion: 'I = V / R = 110 / 22 = 5A'
                },
                {
                    tipo: 'multiple',
                    pregunta: 'Si el voltaje es constante y la resistencia aumenta, la corriente:',
                    opciones: ['Aumenta', 'Disminuye', 'No cambia', 'Se duplica'],
                    respuestaCorrecta: 1,
                    explicacion: 'Seg√∫n I = V/R, si R aumenta, I disminuye'
                },
                // TIPO: Verdadero o Falso
                {
                    tipo: 'verdadero-falso',
                    pregunta: 'Si duplicamos el voltaje en un circuito, la corriente se duplica (manteniendo la resistencia constante).',
                    respuestaCorrecta: true,
                    explicacion: 'VERDADERO: I = V/R. Si V se duplica, I tambi√©n se duplica'
                },
                {
                    tipo: 'verdadero-falso',
                    pregunta: 'Una resistencia mayor permite que pase m√°s corriente.',
                    respuestaCorrecta: false,
                    explicacion: 'FALSO: I = V/R. Mayor resistencia significa MENOS corriente'
                },
                {
                    tipo: 'verdadero-falso',
                    pregunta: 'La unidad de resistencia el√©ctrica es el Ohmio (Œ©).',
                    respuestaCorrecta: true,
                    explicacion: 'VERDADERO: El Ohmio (Œ©) es la unidad de resistencia'
                },
                {
                    tipo: 'verdadero-falso',
                    pregunta: 'Si la corriente es 0A, significa que la resistencia es infinita.',
                    respuestaCorrecta: false,
                    explicacion: 'FALSO: Corriente 0A puede significar que no hay voltaje o que el circuito est√° abierto'
                },
                {
                    tipo: 'verdadero-falso',
                    pregunta: 'En un cortocircuito (R ‚âà 0), la corriente es muy alta.',
                    respuestaCorrecta: true,
                    explicacion: 'VERDADERO: I = V/R. Si R es muy peque√±a, I es muy grande'
                },
                // M√ÅS PREGUNTAS DE C√ÅLCULO
                {
                    tipo: 'calculo',
                    pregunta: 'Un motor el√©ctrico de 220V consume 4.4A. ¬øCu√°l es su resistencia interna?',
                    respuestaCorrecta: 50,
                    unidad: 'Œ©',
                    margenError: 1,
                    formula: 'R = V / I = 220 / 4.4'
                },
                {
                    tipo: 'calculo',
                    pregunta: '¬øQu√© corriente circula por una resistencia de 100Œ© conectada a 50V?',
                    respuestaCorrecta: 0.5,
                    unidad: 'A',
                    margenError: 0.02,
                    formula: 'I = V / R = 50 / 100'
                },
                {
                    tipo: 'multiple',
                    pregunta: '¬øCu√°l de estos NO es un componente de la Ley de Ohm?',
                    opciones: ['Voltaje (V)', 'Corriente (I)', 'Potencia (W)', 'Resistencia (R)'],
                    respuestaCorrecta: 2,
                    explicacion: 'La Ley de Ohm relaciona V, I y R. La Potencia (W) es otra f√≥rmula'
                },
                {
                    tipo: 'multiple',
                    pregunta: 'Para que pase 1A por 50Œ© necesitas:',
                    opciones: ['25V', '50V', '75V', '100V'],
                    respuestaCorrecta: 1,
                    explicacion: 'V = I √ó R = 1 √ó 50 = 50V'
                }
            ],

            casosReales: [
                {
                    numero: 1,
                    titulo: "Instalaci√≥n El√©ctrica en Finca Rural",
                    contexto: "Don Pedro vive en una vereda de Pitalito y quiere instalar iluminaci√≥n en su finca. Tiene un generador que proporciona <strong>12 voltios</strong>.",
                    situacion: "Compr√≥ una bombilla LED que consume <strong>0.5 amperios</strong> de corriente para iluminar el camino de entrada a su casa.",
                    pregunta: "¬øCu√°l es la resistencia de la bombilla LED?",
                    respuestaCorrecta: 24,
                    unidad: "Œ© (ohmios)",
                    margenError: 0.5,
                    datosConocidos: {
                        V: 12,
                        I: 0.5
                    },
                    formula: "R = V / I",
                    procedimiento: [
                        "Datos: V = 12V, I = 0.5A",
                        "Aplicamos la Ley de Ohm despejando R:",
                        "R = V / I",
                        "R = 12V / 0.5A",
                        "R = 24Œ©"
                    ],
                    explicacionAdicional: "Esta resistencia es t√≠pica de los LEDs de potencia media. La resistencia controla cu√°nta corriente pasa por el LED para que no se queme."
                },
                {
                    numero: 2,
                    titulo: "Reparaci√≥n de Plancha El√©ctrica",
                    contexto: "Do√±a Mar√≠a tiene un taller de costura en Pitalito. Su plancha el√©ctrica dej√≥ de calentar correctamente.",
                    situacion: "La plancha est√° dise√±ada para funcionar con <strong>110 voltios</strong> y debe consumir <strong>5 amperios</strong> para calentar correctamente. Do√±a Mar√≠a sospecha que la resistencia interna se da√±√≥.",
                    pregunta: "¬øCu√°l debe ser la resistencia interna correcta de la plancha?",
                    respuestaCorrecta: 22,
                    unidad: "Œ© (ohmios)",
                    margenError: 0.5,
                    datosConocidos: {
                        V: 110,
                        I: 5
                    },
                    formula: "R = V / I",
                    procedimiento: [
                        "Datos: V = 110V, I = 5A",
                        "Usamos la Ley de Ohm:",
                        "R = V / I",
                        "R = 110V / 5A",
                        "R = 22Œ©"
                    ],
                    explicacionAdicional: "Las planchas el√©ctricas usan resistencias met√°licas que convierten la energ√≠a el√©ctrica en calor. Si la resistencia es mayor, consumir√° menos corriente y calentar√° menos."
                },
                {
                    numero: 3,
                    titulo: "Sistema de Iluminaci√≥n LED en Tienda",
                    contexto: "El se√±or Carlos tiene una tienda de abarrotes en el centro de Pitalito y quiere instalar tiras LED para iluminar las vitrinas.",
                    situacion: "Cada tira LED tiene una resistencia total de <strong>40 ohmios</strong> y funcionar√° con una fuente de <strong>12 voltios</strong>.",
                    pregunta: "¬øCu√°nta corriente consumir√° cada tira LED?",
                    respuestaCorrecta: 0.3,
                    unidad: "A (amperios)",
                    margenError: 0.02,
                    datosConocidos: {
                        V: 12,
                        R: 40
                    },
                    formula: "I = V / R",
                    procedimiento: [
                        "Datos: V = 12V, R = 40Œ©",
                        "Aplicamos la Ley de Ohm:",
                        "I = V / R",
                        "I = 12V / 40Œ©",
                        "I = 0.3A (o 300 mA)"
                    ],
                    explicacionAdicional: "Conocer la corriente que consume cada tira LED es importante para calcular el tama√±o de la fuente de alimentaci√≥n que necesita. Si instala 5 tiras, necesitar√° una fuente de al menos 1.5A (5 √ó 0.3A)."
                },
                {
                    numero: 4,
                    titulo: "Calentador de Agua en Casa Rural",
                    contexto: "Una familia en zona rural cerca de Pitalito instal√≥ un calentador de agua el√©ctrico peque√±o que funciona con un panel solar.",
                    situacion: "El sistema solar proporciona <strong>24 voltios</strong> y el calentador tiene una resistencia interna de <strong>6 ohmios</strong>.",
                    pregunta: "¬øCu√°nta corriente consumir√° el calentador?",
                    respuestaCorrecta: 4,
                    unidad: "A (amperios)",
                    margenError: 0.1,
                    datosConocidos: {
                        V: 24,
                        R: 6
                    },
                    formula: "I = V / R",
                    procedimiento: [
                        "Datos: V = 24V, R = 6Œ©",
                        "Usamos la Ley de Ohm:",
                        "I = V / R",
                        "I = 24V / 6Œ©",
                        "I = 4A"
                    ],
                    explicacionAdicional: "Un consumo de 4A a 24V significa que el calentador usa 96W de potencia (P = V √ó I). Este es un calentador peque√±o, ideal para sistemas solares de baja potencia en zonas rurales."
                },
                {
                    numero: 5,
                    titulo: "Ventilador en Cafeter√≠a",
                    contexto: "Una cafeter√≠a tradicional en Pitalito quiere instalar un ventilador de techo para mejorar la ventilaci√≥n.",
                    situacion: "El ventilador necesita <strong>0.8 amperios</strong> para funcionar correctamente y tiene una resistencia interna de <strong>137.5 ohmios</strong>.",
                    pregunta: "¬øCon qu√© voltaje debe conectarse el ventilador?",
                    respuestaCorrecta: 110,
                    unidad: "V (voltios)",
                    margenError: 2,
                    datosConocidos: {
                        I: 0.8,
                        R: 137.5
                    },
                    formula: "V = I √ó R",
                    procedimiento: [
                        "Datos: I = 0.8A, R = 137.5Œ©",
                        "Aplicamos la Ley de Ohm despejando V:",
                        "V = I √ó R",
                        "V = 0.8A √ó 137.5Œ©",
                        "V = 110V"
                    ],
                    explicacionAdicional: "110V es el voltaje est√°ndar en Colombia para electrodom√©sticos. Es importante verificar que el voltaje de la red el√©ctrica coincida con el requerido por el aparato para evitar da√±os."
                }
            ],

            // MISIONES DEL JUEGO
            retos: [
                {
                    nivel: 1,
                    titulo: "Misi√≥n 1: Iniciaci√≥n Ohm-Venger",
                    descripcion: "Tu primera misi√≥n como recluta: El generador principal est√° fijo en 12V. Ajusta la RESISTENCIA del circuito para estabilizar la corriente y evitar sobrecalentamiento.",
                    tipo: "ajustar-resistencia",
                    voltajeFijo: 12,
                    resistenciaInicial: 100,
                    corrienteObjetivo: 0.24,
                    margenError: 0.04,
                    voltajeAjustable: false,
                    resistenciaAjustable: true
                },
                {
                    nivel: 2,
                    titulo: "Misi√≥n 2: Control de Energ√≠a",
                    descripcion: "¬°Urgente! La resistencia del sistema est√° bloqueada en 50Œ©. Debes ajustar el VOLTAJE del generador para alcanzar la corriente de operaci√≥n segura.",
                    tipo: "ajustar-voltaje",
                    voltajeInicial: 12,
                    resistenciaFija: 50,
                    corrienteObjetivo: 0.30,
                    margenError: 0.04,
                    voltajeAjustable: true,
                    resistenciaAjustable: false
                },
                {
                    nivel: 3,
                    titulo: "Misi√≥n 3: Decisi√≥n R√°pida",
                    descripcion: "Crisis en el sector 7: El sistema opera a 15V y necesita exactamente 0.5A. Selecciona R√ÅPIDO la resistencia correcta antes de que el sistema colapse.",
                    tipo: "opcion-multiple",
                    voltajeFijo: 15,
                    corrienteObjetivo: 0.5,
                    opciones: [20, 30, 40],
                    resistenciaCorrecta: 30,
                    margenError: 0.01,
                    voltajeAjustable: false,
                    resistenciaAjustable: false
                },
                {
                    nivel: 4,
                    titulo: "Misi√≥n 4: C√≥digo Rojo",
                    descripcion: "‚ö†Ô∏è ¬°ALERTA CR√çTICA! El equipo hospit√°lario NO PUEDE superar 0.4A o las vidas estar√°n en peligro. Con 20V de entrada, ajusta la resistencia para mantener ZONA SEGURA (0.33A - 0.40A).",
                    tipo: "ajustar-resistencia",
                    voltajeFijo: 20,
                    resistenciaInicial: 100,
                    corrienteObjetivo: 0.365,
                    corrienteMaxima: 0.40,
                    corrienteMinima: 0.33,
                    margenError: 0.035,
                    voltajeAjustable: false,
                    resistenciaAjustable: true,
                    esCritico: true
                },
                {
                    nivel: 5,
                    titulo: "Misi√≥n 5: Prueba Final Ohm-Venger",
                    descripcion: "¬°MISI√ìN DEFINITIVA! Par√°metros aleatorios en campo real. Demuestra que eres un verdadero Ohm-Venger ajustando AMBOS controles. ¬°El equipo cuenta contigo!",
                    tipo: "ajustar-ambos",
                    voltajeInicial: null,
                    resistenciaInicial: null,
                    corrienteObjetivo: null,
                    margenError: 0.05,
                    voltajeAjustable: true,
                    resistenciaAjustable: true,
                    esAleatorio: true
                }
            ],

            iniciar() {
                this.retoActual = 0;
                this.intentosReto = 0;
                this.aciertosPrimerIntento = 0;
                this.intentosTotales = 0;
                this.cargarReto();
            },

            mostrarInstrucciones() {
                window.scrollTo({ top: 0, behavior: 'smooth' });
                document.getElementById('pantalla-inicio').style.display = 'none';
                document.getElementById('pantalla-instrucciones').style.display = 'block';
            },

            volverInicio() {
                window.scrollTo({ top: 0, behavior: 'smooth' });
                
                // Limpiar temporizador si existe
                if (this.temporizadorDesafio) {
                    clearInterval(this.temporizadorDesafio);
                    this.temporizadorDesafio = null;
                }
                
                // Actualizar estado del m√≥dulo de certificaci√≥n
                this.actualizarEstadoCertificacion();
                
                document.getElementById('pantalla-inicio').style.display = 'block';
                document.getElementById('pantalla-instrucciones').style.display = 'none';
                document.getElementById('pantalla-juego').style.display = 'none';
                document.getElementById('pantalla-final').style.display = 'none';
                document.getElementById('pantalla-casos-reales').style.display = 'none';
                document.getElementById('pantalla-desafios').style.display = 'none';
                document.getElementById('pantalla-certificacion').style.display = 'none';
            },

            // CASOS REALES
            mostrarCasosReales() {
                window.scrollTo({ top: 0, behavior: 'smooth' });
                document.getElementById('pantalla-inicio').style.display = 'none';
                document.getElementById('pantalla-casos-reales').style.display = 'block';
                this.casoActual = 0;
                this.respuestasCasosCorrectas = 0;
                this.cargarCasoReal();
            },

            cargarCasoReal() {
                window.scrollTo({ top: 0, behavior: 'smooth' });
                const caso = this.casosReales[this.casoActual];
                document.getElementById('progreso-casos').textContent = `Caso ${this.casoActual + 1} de ${this.casosReales.length}`;

                const contenedor = document.getElementById('caso-contenedor');
                contenedor.innerHTML = `
                    <div class="caso-historia">
                        <h3>üìñ ${caso.titulo}</h3>
                        <p>${caso.contexto}</p>
                        <p>${caso.situacion}</p>
                    </div>

                    <div class="caso-pregunta">
                        <h4>‚ùì ${caso.pregunta}</h4>
                        <div class="caso-input-group">
                            <label>Tu respuesta:</label>
                            <input type="number" id="respuesta-caso" step="0.01" placeholder="0">
                            <span class="caso-unidad">${caso.unidad}</span>
                        </div>
                    </div>

                    <div class="caso-resultado" id="caso-resultado">
                        <!-- Resultado se mostrar√° aqu√≠ -->
                    </div>

                    <div class="caso-botones">
                        <button onclick="juego.verificarCasoReal()">‚úÖ Verificar Respuesta</button>
                        <button class="secondary" onclick="juego.reiniciarCaso()">üîÑ Limpiar</button>
                    </div>
                `;

                // Focus en el input
                setTimeout(() => {
                    document.getElementById('respuesta-caso').focus();
                }, 100);

                // Permitir Enter para verificar
                document.getElementById('respuesta-caso').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        this.verificarCasoReal();
                    }
                });
            },

            verificarCasoReal() {
                const caso = this.casosReales[this.casoActual];
                const respuestaInput = document.getElementById('respuesta-caso');
                const respuestaUsuario = parseFloat(respuestaInput.value);

                if (isNaN(respuestaUsuario)) {
                    alert('‚ö†Ô∏è Por favor ingresa un n√∫mero v√°lido');
                    return;
                }

                const diferencia = Math.abs(respuestaUsuario - caso.respuestaCorrecta);
                const esCorrecta = diferencia <= caso.margenError;

                const resultadoDiv = document.getElementById('caso-resultado');
                resultadoDiv.style.display = 'block';

                if (esCorrecta) {
                    this.respuestasCasosCorrectas++;
                    resultadoDiv.className = 'caso-resultado correcto';
                    
                    let html = `
                        <h4>‚úÖ ¬°Respuesta Correcta!</h4>
                        <div class="caso-explicacion">
                            <p><strong>Soluci√≥n:</strong></p>
                            <div class="caso-calculo">
                    `;
                    
                    caso.procedimiento.forEach(paso => {
                        html += `<div>${paso}</div>`;
                    });
                    
                    html += `
                            </div>
                            <p style="margin-top: 15px;"><strong>üí° Dato importante:</strong></p>
                            <p>${caso.explicacionAdicional}</p>
                        </div>
                    `;

                    if (this.casoActual < this.casosReales.length - 1) {
                        html += `
                            <div style="margin-top: 25px;">
                                <button onclick="juego.siguienteCaso()">‚û°Ô∏è Siguiente Caso</button>
                            </div>
                        `;
                    } else {
                        html += `
                            <div style="margin-top: 25px;">
                                <button onclick="juego.finalizarCasosReales()">üèÜ Ver Resultados</button>
                            </div>
                        `;
                    }

                    resultadoDiv.innerHTML = html;

                } else {
                    resultadoDiv.className = 'caso-resultado incorrecto';
                    
                    let pista = '';
                    if (respuestaUsuario > caso.respuestaCorrecta) {
                        pista = 'Tu respuesta es muy alta. Revisa tus c√°lculos.';
                    } else {
                        pista = 'Tu respuesta es muy baja. Revisa tus c√°lculos.';
                    }

                    let html = `
                        <h4>‚ùå Respuesta Incorrecta</h4>
                        <div class="caso-explicacion">
                            <p><strong>Tu respuesta:</strong> ${respuestaUsuario} ${caso.unidad}</p>
                            <p><strong>Respuesta correcta:</strong> ${caso.respuestaCorrecta} ${caso.unidad}</p>
                            <p style="margin-top: 15px;"><strong>üí° Pista:</strong> ${pista}</p>
                            <p style="margin-top: 10px;"><strong>F√≥rmula a usar:</strong> ${caso.formula}</p>
                            <p><strong>Datos conocidos:</strong></p>
                            <div class="caso-calculo">
                    `;

                    for (let [clave, valor] of Object.entries(caso.datosConocidos)) {
                        html += `<div>${clave} = ${valor}</div>`;
                    }

                    html += `
                            </div>
                        </div>
                        <div style="margin-top: 25px;">
                            <button onclick="juego.reiniciarCaso()">üîÑ Intentar de Nuevo</button>
                        </div>
                    `;

                    resultadoDiv.innerHTML = html;
                }

                // Deshabilitar input despu√©s de verificar
                respuestaInput.disabled = true;
            },

            reiniciarCaso() {
                const respuestaInput = document.getElementById('respuesta-caso');
                respuestaInput.value = '';
                respuestaInput.disabled = false;
                respuestaInput.focus();
                document.getElementById('caso-resultado').style.display = 'none';
            },

            siguienteCaso() {
                this.casoActual++;
                this.cargarCasoReal();
            },

            finalizarCasosReales() {
                window.scrollTo({ top: 0, behavior: 'smooth' });
                
                // Registrar progreso para certificaci√≥n
                this.modulosCompletados.casosReales = true;
                this.resultadosGlobales.casosReales.correctas = this.respuestasCasosCorrectas;
                
                const porcentaje = (this.respuestasCasosCorrectas / this.casosReales.length) * 100;
                
                let mensaje = '';
                let emoji = '';
                if (porcentaje === 100) {
                    mensaje = '¬°PERFECTO! Dominaste todos los casos reales.';
                    emoji = 'üèÜ';
                } else if (porcentaje >= 80) {
                    mensaje = '¬°EXCELENTE! Muy buen desempe√±o en casos pr√°cticos.';
                    emoji = '‚≠ê';
                } else if (porcentaje >= 60) {
                    mensaje = '¬°BIEN! Sigue practicando para mejorar.';
                    emoji = 'üí™';
                } else {
                    mensaje = 'Necesitas repasar la Ley de Ohm. ¬°Int√©ntalo de nuevo!';
                    emoji = 'üìö';
                }

                const contenedor = document.getElementById('caso-contenedor');
                contenedor.innerHTML = `
                    <div class="victoria-hero">
                        <h1>${emoji} CASOS REALES COMPLETADOS ${emoji}</h1>
                        <p style="font-size: 1.3em; margin-top: 20px;">${mensaje}</p>
                    </div>

                    <div class="estadisticas">
                        <h2 style="color: #667eea; font-size: 2em; margin-bottom: 30px;">üìä TUS RESULTADOS</h2>
                        <div class="estadistica-item">
                            Casos resueltos correctamente: <strong>${this.respuestasCasosCorrectas} de ${this.casosReales.length}</strong>
                        </div>
                        <div class="estadistica-item">
                            Porcentaje de acierto: <strong>${porcentaje.toFixed(0)}%</strong>
                        </div>
                    </div>

                    <div style="text-align: center; margin-top: 30px;">
                        <button onclick="juego.mostrarCasosReales()">üîÑ Intentar de Nuevo</button>
                        <button class="secondary" onclick="juego.volverInicio()">üè† Men√∫ Principal</button>
                    </div>
                `;
            },

            iniciarJuego() {
                window.scrollTo({ top: 0, behavior: 'smooth' });
                document.getElementById('pantalla-inicio').style.display = 'none';
                document.getElementById('pantalla-instrucciones').style.display = 'none';
                document.getElementById('pantalla-juego').style.display = 'block';
                this.iniciar();
            },

            cargarReto() {
                const reto = this.retos[this.retoActual];
                this.intentosReto = 0;
                this.respuestaSeleccionada = null;

                window.scrollTo({ top: 0, behavior: 'smooth' });

                if (reto.esAleatorio) {
                    reto.voltajeInicial = Math.floor(Math.random() * 15) + 5;
                    reto.resistenciaInicial = Math.floor(Math.random() * 150) + 50;
                    reto.corrienteObjetivo = parseFloat((Math.random() * 0.3 + 0.2).toFixed(2));
                }

                document.getElementById('titulo-mision').textContent = reto.titulo;
                document.getElementById('progreso').textContent = `Misi√≥n ${this.retoActual + 1} de ${this.retos.length}`;
                document.getElementById('texto-descripcion-reto').textContent = reto.descripcion;

                if (reto.tipo === 'opcion-multiple') {
                    this.configurarOpcionMultiple(reto);
                } else {
                    this.configurarControlesNormales(reto);
                }

                if (reto.esCritico) {
                    document.getElementById('objetivo-box').innerHTML = 
                        `‚ö†Ô∏è ZONA SEGURA: ${reto.corrienteMinima}A - ${reto.corrienteMaxima}A`;
                } else {
                    document.getElementById('objetivo-box').innerHTML = 
                        `üéØ OBJETIVO: Lograr una corriente de <span id="objetivo-corriente">${reto.corrienteObjetivo.toFixed(2)}</span> A`;
                }

                this.calcularCorriente();
            },

            configurarControlesNormales(reto) {
                document.getElementById('controles-normales').style.display = 'block';
                document.getElementById('opciones-multiples').classList.add('oculto');

                const sliderVoltaje = document.getElementById('slider-voltaje');
                const sliderResistencia = document.getElementById('slider-resistencia');
                const controlVoltaje = document.getElementById('control-voltaje');
                const controlResistencia = document.getElementById('control-resistencia');

                if (reto.voltajeAjustable) {
                    controlVoltaje.style.display = 'block';
                    sliderVoltaje.value = reto.voltajeInicial || 12;
                    sliderVoltaje.disabled = false;
                    sliderVoltaje.oninput = () => this.calcularCorriente();
                } else {
                    controlVoltaje.style.display = 'block';
                    sliderVoltaje.value = reto.voltajeFijo;
                    sliderVoltaje.disabled = true;
                    document.getElementById('valor-voltaje').style.background = '#6c757d';
                }

                if (reto.resistenciaAjustable) {
                    controlResistencia.style.display = 'block';
                    sliderResistencia.value = reto.resistenciaInicial || 100;
                    sliderResistencia.disabled = false;
                    sliderResistencia.oninput = () => this.calcularCorriente();
                    document.getElementById('valor-resistencia').style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
                } else {
                    controlResistencia.style.display = 'block';
                    sliderResistencia.value = reto.resistenciaFija;
                    sliderResistencia.disabled = true;
                    document.getElementById('valor-resistencia').style.background = '#6c757d';
                }
            },

            configurarOpcionMultiple(reto) {
                document.getElementById('controles-normales').style.display = 'none';
                document.getElementById('opciones-multiples').classList.remove('oculto');

                const contenedor = document.getElementById('opciones-multiples');
                contenedor.innerHTML = '<p style="width: 100%; text-align: center; font-size: 1.3em; margin-bottom: 25px;"><strong>Selecciona la resistencia correcta:</strong></p>';

                document.getElementById('display-voltaje').textContent = `${reto.voltajeFijo} V`;
                document.getElementById('display-resistencia').textContent = '? Œ©';

                reto.opciones.forEach(resistencia => {
                    const btn = document.createElement('button');
                    btn.className = 'opcion-btn';
                    btn.textContent = `${resistencia} Œ©`;
                    btn.onclick = () => {
                        document.querySelectorAll('.opcion-btn').forEach(b => {
                            b.style.background = 'white';
                            b.style.color = '#667eea';
                        });
                        btn.style.background = '#667eea';
                        btn.style.color = 'white';
                        this.respuestaSeleccionada = resistencia;
                        
                        const corriente = reto.voltajeFijo / resistencia;
                        document.getElementById('lectura-corriente').textContent = corriente.toFixed(3) + ' A';
                    };
                    contenedor.appendChild(btn);
                });
            },

            calcularCorriente() {
                const reto = this.retos[this.retoActual];
                
                if (reto.tipo === 'opcion-multiple') {
                    return;
                }

                const voltaje = parseFloat(document.getElementById('slider-voltaje').value);
                const resistencia = parseFloat(document.getElementById('slider-resistencia').value);
                const corriente = voltaje / resistencia;

                document.getElementById('display-voltaje').textContent = `${voltaje} V`;
                document.getElementById('display-resistencia').textContent = `${resistencia} Œ©`;
                document.getElementById('valor-voltaje').textContent = `${voltaje} V`;
                document.getElementById('valor-resistencia').textContent = `${resistencia} Œ©`;
                document.getElementById('lectura-corriente').textContent = corriente.toFixed(3) + ' A';

                return corriente;
            },

            comprobarRespuesta() {
                const reto = this.retos[this.retoActual];
                this.intentosReto++;
                this.intentosTotales++;

                let corrienteObtenida;
                let esCorrecta = false;

                if (reto.tipo === 'opcion-multiple') {
                    if (this.respuestaSeleccionada === null) {
                        alert('‚ö†Ô∏è Debes seleccionar una opci√≥n primero');
                        return;
                    }
                    corrienteObtenida = reto.voltajeFijo / this.respuestaSeleccionada;
                    esCorrecta = this.respuestaSeleccionada === reto.resistenciaCorrecta;
                } else {
                    corrienteObtenida = this.calcularCorriente();
                    const diferencia = Math.abs(corrienteObtenida - reto.corrienteObjetivo);
                    esCorrecta = diferencia <= reto.margenError;

                    if (reto.esCritico) {
                        esCorrecta = corrienteObtenida >= reto.corrienteMinima && 
                                    corrienteObtenida <= reto.corrienteMaxima;
                    }
                }

                this.mostrarResultado(esCorrecta, corrienteObtenida);
            },

            mostrarResultado(esCorrecta, corrienteObtenida) {
                const reto = this.retos[this.retoActual];
                const modal = document.getElementById('resultado-modal');
                const icono = document.getElementById('resultado-icono');
                const titulo = document.getElementById('resultado-titulo');
                const explicacion = document.getElementById('resultado-explicacion');

                modal.style.display = 'flex';

                if (esCorrecta) {
                    if (this.intentosReto === 1) {
                        this.aciertosPrimerIntento++;
                    }

                    icono.textContent = 'üéâ';
                    titulo.textContent = '¬°MISI√ìN CUMPLIDA!';
                    titulo.className = 'resultado-titulo exito';

                    let explicacionTexto = `<p><strong>¬°Excelente trabajo, Ohm-Venger! Has estabilizado el circuito con √©xito.</strong></p>`;
                    
                    if (reto.tipo === 'opcion-multiple') {
                        const V = reto.voltajeFijo;
                        const R = reto.resistenciaCorrecta;
                        const I = (V / R).toFixed(3);
                        explicacionTexto += `
                            <p style="margin-top: 15px;"><strong>‚ö° An√°lisis de la Ley de Ohm:</strong></p>
                            <p>I = V / R</p>
                            <p>I = ${V}V / ${R}Œ© = ${I} A</p>
                            <p style="margin-top: 15px;">Seleccionaste correctamente <strong>${R}Œ©</strong>, logrando exactamente la corriente objetivo de <strong>${reto.corrienteObjetivo}A</strong>.</p>
                        `;
                    } else {
                        const V = parseFloat(document.getElementById('slider-voltaje').value);
                        const R = parseFloat(document.getElementById('slider-resistencia').value);
                        const I = corrienteObtenida.toFixed(3);
                        
                        explicacionTexto += `
                            <p style="margin-top: 15px;"><strong>‚ö° Par√°metros utilizados:</strong></p>
                            <p>‚Ä¢ Voltaje (V) = ${V} V</p>
                            <p>‚Ä¢ Resistencia (R) = ${R} Œ©</p>
                            <p>‚Ä¢ Corriente obtenida (I) = ${I} A</p>
                            <p style="margin-top: 15px;"><strong>Verificaci√≥n:</strong></p>
                            <p>I = V / R = ${V} / ${R} = ${I} A ‚úì</p>
                        `;

                        if (reto.esCritico) {
                            explicacionTexto += `<p style="margin-top: 15px; color: #28a745;"><strong>‚úì Corriente en ZONA SEGURA. ¬°Salvaste vidas!</strong></p>`;
                        }
                    }

                    explicacion.innerHTML = explicacionTexto;

                    const botonSiguiente = document.querySelector('#resultado-modal button');
                    botonSiguiente.textContent = '‚û°Ô∏è Siguiente Misi√≥n';
                    botonSiguiente.onclick = () => this.siguienteReto();

                } else {
                    icono.textContent = '‚ö†Ô∏è';
                    titulo.textContent = '¬°Reint√©ntalo!';
                    titulo.className = 'resultado-titulo error';

                    let explicacionTexto = `<p><strong>No te rindas, Ohm-Venger. Analiza los datos:</strong></p>`;
                    explicacionTexto += `<p>Corriente obtenida: <strong>${corrienteObtenida.toFixed(3)} A</strong></p>`;
                    explicacionTexto += `<p>Corriente objetivo: <strong>${reto.corrienteObjetivo.toFixed(2)} A</strong></p>`;

                    if (reto.tipo === 'opcion-multiple') {
                        explicacionTexto += `<p style="margin-top: 15px;"><strong>üí° Pista:</strong> Usa R = V / I. Con V=${reto.voltajeFijo}V e I=${reto.corrienteObjetivo}A, calcula R.</p>`;
                    } else {
                        if (corrienteObtenida > reto.corrienteObjetivo) {
                            if (reto.resistenciaAjustable) {
                                explicacionTexto += `<p style="margin-top: 15px;"><strong>üí° Estrategia:</strong> Corriente muy alta. <strong>AUMENTA la resistencia</strong> para reducirla.</p>`;
                            } else {
                                explicacionTexto += `<p style="margin-top: 15px;"><strong>üí° Estrategia:</strong> Corriente muy alta. <strong>REDUCE el voltaje</strong>.</p>`;
                            }
                        } else {
                            if (reto.resistenciaAjustable) {
                                explicacionTexto += `<p style="margin-top: 15px;"><strong>üí° Estrategia:</strong> Corriente muy baja. <strong>REDUCE la resistencia</strong>.</p>`;
                            } else {
                                explicacionTexto += `<p style="margin-top: 15px;"><strong>üí° Estrategia:</strong> Corriente muy baja. <strong>AUMENTA el voltaje</strong>.</p>`;
                            }
                        }

                        if (reto.esCritico && corrienteObtenida > reto.corrienteMaxima) {
                            explicacionTexto += `<p style="color: #dc3545; margin-top: 10px;"><strong>üö® ¬°PELIGRO! Esa corriente da√±ar√≠a el equipo.</strong></p>`;
                        }
                    }

                    explicacion.innerHTML = explicacionTexto;

                    const botonSiguiente = document.querySelector('#resultado-modal button');
                    botonSiguiente.textContent = 'üîÑ Reintentar Misi√≥n';
                    botonSiguiente.onclick = () => this.cerrarModal();
                    return;
                }
            },

            cerrarModal() {
                document.getElementById('resultado-modal').style.display = 'none';
            },

            siguienteReto() {
                this.cerrarModal();
                this.retoActual++;

                if (this.retoActual >= this.retos.length) {
                    this.mostrarPantallaFinal();
                } else {
                    this.cargarReto();
                }
            },

            reiniciarReto() {
                this.cargarReto();
            },

            mostrarPantallaFinal() {
                window.scrollTo({ top: 0, behavior: 'smooth' });
                document.getElementById('pantalla-juego').style.display = 'none';
                document.getElementById('pantalla-final').style.display = 'block';

                // Registrar progreso para certificaci√≥n
                this.modulosCompletados.simulaciones = true;
                this.resultadosGlobales.simulaciones.completadas = this.retos.length;
                this.resultadosGlobales.simulaciones.aciertosDirectos = this.aciertosPrimerIntento;

                document.getElementById('retos-completados').textContent = `${this.retos.length} de ${this.retos.length}`;
                document.getElementById('aciertos-primer-intento').textContent = this.aciertosPrimerIntento;
                document.getElementById('intentos-totales').textContent = this.intentosTotales;

                const porcentaje = (this.aciertosPrimerIntento / this.retos.length) * 100;
                let mensaje = '';

                if (porcentaje === 100) {
                    mensaje = 'üèÜ ¬°PERFECCI√ìN ABSOLUTA! Todas las misiones al primer intento. Eres un MAESTRO Ohm-Venger.';
                } else if (porcentaje >= 80) {
                    mensaje = '‚≠ê ¬°DESTACADO! Dominas la Ley de Ohm como un verdadero h√©roe. ¬°Impresionante!';
                } else if (porcentaje >= 60) {
                    mensaje = 'üí™ ¬°MUY BIEN! Has demostrado ser un Ohm-Venger competente. Sigue entrenando.';
                } else {
                    mensaje = 'üéØ ¬°BUEN TRABAJO! Has completado el entrenamiento. Practica m√°s para alcanzar la excelencia.';
                }

                document.getElementById('mensaje-final').textContent = mensaje;
            },

            // DESAF√çOS
            mostrarDesafios() {
                window.scrollTo({ top: 0, behavior: 'smooth' });
                document.getElementById('pantalla-inicio').style.display = 'none';
                document.getElementById('pantalla-desafios').style.display = 'block';
                
                // Reiniciar variables
                this.desafioActual = 0;
                this.puntosDesafio = 0;
                this.tiempoRestante = 180;
                this.respuestasDesafio = [];
                
                // Seleccionar 10 preguntas aleatorias
                this.preguntasDesafio = this.seleccionarPreguntasAleatorias(10);
                
                // Iniciar temporizador
                this.iniciarTemporizador();
                
                // Cargar primera pregunta
                this.cargarPreguntaDesafio();
            },

            seleccionarPreguntasAleatorias(cantidad) {
                const copia = [...this.bancoPreguntas];
                const seleccionadas = [];
                
                for (let i = 0; i < cantidad && copia.length > 0; i++) {
                    const indiceAleatorio = Math.floor(Math.random() * copia.length);
                    seleccionadas.push(copia[indiceAleatorio]);
                    copia.splice(indiceAleatorio, 1);
                }
                
                return seleccionadas;
            },

            iniciarTemporizador() {
                this.actualizarCronometro();
                
                this.temporizadorDesafio = setInterval(() => {
                    this.tiempoRestante--;
                    this.actualizarCronometro();
                    
                    if (this.tiempoRestante <= 30) {
                        document.getElementById('cronometro').classList.add('advertencia');
                    }
                    
                    if (this.tiempoRestante <= 0) {
                        clearInterval(this.temporizadorDesafio);
                        this.finalizarDesafiosPorTiempo();
                    }
                }, 1000);
            },

            actualizarCronometro() {
                const minutos = Math.floor(this.tiempoRestante / 60);
                const segundos = this.tiempoRestante % 60;
                const textoTiempo = `‚è±Ô∏è ${minutos}:${segundos.toString().padStart(2, '0')}`;
                document.getElementById('cronometro').textContent = textoTiempo;
            },

            cargarPreguntaDesafio() {
                window.scrollTo({ top: 0, behavior: 'smooth' });
                
                if (this.desafioActual >= this.preguntasDesafio.length) {
                    this.finalizarDesafios();
                    return;
                }
                
                const pregunta = this.preguntasDesafio[this.desafioActual];
                
                document.getElementById('progreso-desafios').textContent = 
                    `Pregunta ${this.desafioActual + 1} de ${this.preguntasDesafio.length}`;
                document.getElementById('puntos-desafio').textContent = `‚≠ê ${this.puntosDesafio} puntos`;
                
                const contenedor = document.getElementById('desafio-contenedor');
                
                let html = `
                    <div class="desafio-pregunta">
                        <h3>‚ùì Pregunta ${this.desafioActual + 1}</h3>
                        <p>${pregunta.pregunta}</p>
                    </div>
                `;
                
                if (pregunta.tipo === 'calculo') {
                    html += `
                        <div class="desafio-input">
                            <label style="font-size: 1.2em; font-weight: bold;">Tu respuesta:</label>
                            <input type="number" id="respuesta-desafio" step="0.01" placeholder="0">
                            <span style="font-size: 1.2em; font-weight: bold; color: #667eea;">${pregunta.unidad}</span>
                        </div>
                    `;
                } else if (pregunta.tipo === 'multiple') {
                    html += `<div class="desafio-opciones">`;
                    pregunta.opciones.forEach((opcion, index) => {
                        html += `
                            <div class="desafio-opcion" onclick="juego.seleccionarOpcionDesafio(${index})">
                                ${opcion}
                            </div>
                        `;
                    });
                    html += `</div>`;
                } else if (pregunta.tipo === 'verdadero-falso') {
                    html += `
                        <div class="desafio-opciones" style="grid-template-columns: 1fr 1fr;">
                            <div class="desafio-opcion" onclick="juego.seleccionarVerdaderoFalso(true)">
                                ‚úÖ VERDADERO
                            </div>
                            <div class="desafio-opcion" onclick="juego.seleccionarVerdaderoFalso(false)">
                                ‚ùå FALSO
                            </div>
                        </div>
                    `;
                }
                
                html += `
                    <div class="desafio-feedback" id="desafio-feedback"></div>
                    
                    <div style="text-align: center; margin-top: 25px;">
                        <button onclick="juego.verificarRespuestaDesafio()">‚úÖ Responder</button>
                    </div>
                `;
                
                contenedor.innerHTML = html;
                
                // Focus en input si es c√°lculo
                if (pregunta.tipo === 'calculo') {
                    setTimeout(() => {
                        const input = document.getElementById('respuesta-desafio');
                        input.focus();
                        input.addEventListener('keypress', (e) => {
                            if (e.key === 'Enter') {
                                this.verificarRespuestaDesafio();
                            }
                        });
                    }, 100);
                }
            },

            seleccionarOpcionDesafio(index) {
                // Limpiar selecciones anteriores
                document.querySelectorAll('.desafio-opcion').forEach(opcion => {
                    opcion.classList.remove('seleccionada');
                });
                
                // Marcar como seleccionada
                document.querySelectorAll('.desafio-opcion')[index].classList.add('seleccionada');
                
                // Guardar respuesta
                this.respuestaSeleccionada = index;
            },

            seleccionarVerdaderoFalso(valor) {
                // Limpiar selecciones anteriores
                document.querySelectorAll('.desafio-opcion').forEach(opcion => {
                    opcion.classList.remove('seleccionada');
                });
                
                // Marcar como seleccionada
                if (valor) {
                    document.querySelectorAll('.desafio-opcion')[0].classList.add('seleccionada');
                } else {
                    document.querySelectorAll('.desafio-opcion')[1].classList.add('seleccionada');
                }
                
                // Guardar respuesta
                this.respuestaSeleccionada = valor;
            },

            verificarRespuestaDesafio() {
                const pregunta = this.preguntasDesafio[this.desafioActual];
                let esCorrecta = false;
                let respuestaUsuario = null;
                
                if (pregunta.tipo === 'calculo') {
                    const input = document.getElementById('respuesta-desafio');
                    respuestaUsuario = parseFloat(input.value);
                    
                    if (isNaN(respuestaUsuario)) {
                        alert('‚ö†Ô∏è Por favor ingresa un n√∫mero v√°lido');
                        return;
                    }
                    
                    const diferencia = Math.abs(respuestaUsuario - pregunta.respuestaCorrecta);
                    esCorrecta = diferencia <= pregunta.margenError;
                    input.disabled = true;
                    
                } else if (pregunta.tipo === 'multiple' || pregunta.tipo === 'verdadero-falso') {
                    if (this.respuestaSeleccionada === null) {
                        alert('‚ö†Ô∏è Por favor selecciona una opci√≥n');
                        return;
                    }
                    
                    respuestaUsuario = this.respuestaSeleccionada;
                    esCorrecta = respuestaUsuario === pregunta.respuestaCorrecta;
                    
                    // Deshabilitar opciones
                    document.querySelectorAll('.desafio-opcion').forEach(opcion => {
                        opcion.style.pointerEvents = 'none';
                    });
                }
                
                // Actualizar puntos
                if (esCorrecta) {
                    this.puntosDesafio += 10;
                } else {
                    this.puntosDesafio -= 5;
                    if (this.puntosDesafio < 0) this.puntosDesafio = 0;
                }
                
                document.getElementById('puntos-desafio').textContent = `‚≠ê ${this.puntosDesafio} puntos`;
                
                // Guardar resultado
                this.respuestasDesafio.push({
                    pregunta: pregunta.pregunta,
                    correcta: esCorrecta
                });
                
                // Mostrar feedback
                this.mostrarFeedbackDesafio(esCorrecta, pregunta, respuestaUsuario);
            },

            mostrarFeedbackDesafio(esCorrecta, pregunta, respuestaUsuario) {
                const feedbackDiv = document.getElementById('desafio-feedback');
                feedbackDiv.style.display = 'block';
                
                if (esCorrecta) {
                    feedbackDiv.className = 'desafio-feedback correcto';
                    feedbackDiv.innerHTML = `
                        <h4>‚úÖ ¬°Correcto! +10 puntos</h4>
                        <p>${pregunta.explicacion || pregunta.formula || ''}</p>
                        <div style="margin-top: 15px;">
                            <button onclick="juego.siguientePreguntaDesafio()">‚û°Ô∏è Siguiente</button>
                        </div>
                    `;
                } else {
                    feedbackDiv.className = 'desafio-feedback incorrecto';
                    let textoRespuesta = '';
                    
                    if (pregunta.tipo === 'calculo') {
                        textoRespuesta = `
                            <p><strong>Tu respuesta:</strong> ${respuestaUsuario} ${pregunta.unidad}</p>
                            <p><strong>Respuesta correcta:</strong> ${pregunta.respuestaCorrecta} ${pregunta.unidad}</p>
                        `;
                    } else if (pregunta.tipo === 'multiple') {
                        textoRespuesta = `
                            <p><strong>Respuesta correcta:</strong> ${pregunta.opciones[pregunta.respuestaCorrecta]}</p>
                        `;
                    }
                    
                    feedbackDiv.innerHTML = `
                        <h4>‚ùå Incorrecto -5 puntos</h4>
                        ${textoRespuesta}
                        <p>${pregunta.explicacion || pregunta.formula || ''}</p>
                        <div style="margin-top: 15px;">
                            <button onclick="juego.siguientePreguntaDesafio()">‚û°Ô∏è Siguiente</button>
                        </div>
                    `;
                }
                
                // Ocultar bot√≥n de responder
                feedbackDiv.previousElementSibling.style.display = 'none';
            },

            siguientePreguntaDesafio() {
                this.respuestaSeleccionada = null;
                this.desafioActual++;
                this.cargarPreguntaDesafio();
            },

            finalizarDesafios() {
                clearInterval(this.temporizadorDesafio);
                this.mostrarResultadosDesafio();
            },

            finalizarDesafiosPorTiempo() {
                alert('‚è∞ ¬°Se acab√≥ el tiempo!');
                this.mostrarResultadosDesafio();
            },

            mostrarResultadosDesafio() {
                window.scrollTo({ top: 0, behavior: 'smooth' });
                
                // Registrar progreso para certificaci√≥n
                this.modulosCompletados.desafios = true;
                this.resultadosGlobales.desafios.puntos = this.puntosDesafio;
                
                const aciertos = this.respuestasDesafio.filter(r => r.correcta).length;
                const total = this.preguntasDesafio.length;
                const porcentaje = (aciertos / total) * 100;
                
                let rango = '';
                let emoji = '';
                let mensaje = '';
                let color = '';
                
                if (this.puntosDesafio >= 80) {
                    rango = 'MAESTRO OHM-VENGER';
                    emoji = 'üèÜ';
                    mensaje = '¬°Dominaci√≥n total! Eres un experto en la Ley de Ohm.';
                    color = '#ffd700';
                } else if (this.puntosDesafio >= 60) {
                    rango = 'EXPERTO';
                    emoji = '‚≠ê';
                    mensaje = '¬°Excelente desempe√±o! Conoces muy bien la Ley de Ohm.';
                    color = '#667eea';
                } else if (this.puntosDesafio >= 40) {
                    rango = 'APRENDIZ';
                    emoji = 'üí™';
                    mensaje = 'Buen trabajo. Sigue practicando para mejorar.';
                    color = '#48dbfb';
                } else {
                    rango = 'NOVATO';
                    emoji = 'üìö';
                    mensaje = 'Necesitas m√°s pr√°ctica. ¬°No te rindas!';
                    color = '#ff9ff3';
                }
                
                const contenedor = document.getElementById('desafio-contenedor');
                contenedor.innerHTML = `
                    <div style="background: linear-gradient(135deg, ${color}22 0%, ${color}44 100%); padding: 50px; border-radius: 25px; text-align: center;">
                        <h1 style="font-size: 4em; margin-bottom: 20px;">${emoji}</h1>
                        <h2 style="color: ${color}; font-size: 2.5em; margin-bottom: 20px;">${rango}</h2>
                        <p style="font-size: 1.3em; color: #333; margin-bottom: 30px;">${mensaje}</p>
                    </div>

                    <div class="estadisticas" style="margin-top: 40px;">
                        <h2 style="color: #667eea; font-size: 2em; margin-bottom: 30px;">üìä RESULTADOS FINALES</h2>
                        <div class="estadistica-item">
                            Puntuaci√≥n Total: <strong style="color: ${color};">${this.puntosDesafio} puntos</strong>
                        </div>
                        <div class="estadistica-item">
                            Respuestas correctas: <strong>${aciertos} de ${total}</strong>
                        </div>
                        <div class="estadistica-item">
                            Porcentaje de acierto: <strong>${porcentaje.toFixed(0)}%</strong>
                        </div>
                        <div class="estadistica-item">
                            Tiempo usado: <strong>${Math.floor((180 - this.tiempoRestante) / 60)}:${((180 - this.tiempoRestante) % 60).toString().padStart(2, '0')}</strong>
                        </div>
                    </div>

                    <div style="text-align: center; margin-top: 40px;">
                        <button onclick="juego.mostrarDesafios()">üîÑ Nuevo Desaf√≠o</button>
                        <button class="secondary" onclick="juego.volverInicio()">üè† Men√∫ Principal</button>
                    </div>
                `;
            },

            // CERTIFICACI√ìN
            actualizarEstadoCertificacion() {
                const moduloCert = document.getElementById('modulo-certificacion');
                const badgeBloqueado = document.getElementById('badge-bloqueado');
                
                const todoCompleto = this.modulosCompletados.simulaciones && 
                                    this.modulosCompletados.casosReales && 
                                    this.modulosCompletados.desafios;
                
                if (todoCompleto) {
                    moduloCert.classList.remove('bloqueado');
                    badgeBloqueado.innerHTML = '‚úÖ Disponible';
                    badgeBloqueado.style.color = '#28a745';
                } else {
                    moduloCert.classList.add('bloqueado');
                    const faltantes = [];
                    if (!this.modulosCompletados.simulaciones) faltantes.push('Simulaciones');
                    if (!this.modulosCompletados.casosReales) faltantes.push('Casos Reales');
                    if (!this.modulosCompletados.desafios) faltantes.push('Desaf√≠os');
                    badgeBloqueado.innerHTML = `üîí Falta: ${faltantes.join(', ')}`;
                }
            },

            mostrarCertificacion() {
                const todoCompleto = this.modulosCompletados.simulaciones && 
                                    this.modulosCompletados.casosReales && 
                                    this.modulosCompletados.desafios;
                
                if (!todoCompleto) {
                    const faltantes = [];
                    if (!this.modulosCompletados.simulaciones) faltantes.push('‚Ä¢ Simulaciones (5 misiones)');
                    if (!this.modulosCompletados.casosReales) faltantes.push('‚Ä¢ Casos Reales (5 casos)');
                    if (!this.modulosCompletados.desafios) faltantes.push('‚Ä¢ Desaf√≠os (examen cronometrado)');
                    
                    alert(`üîí Certificaci√≥n Bloqueada\n\nDebe completar todos los m√≥dulos primero:\n\n${faltantes.join('\n')}\n\n¬°Completa los m√≥dulos para obtener tu certificado!`);
                    return;
                }
                
                window.scrollTo({ top: 0, behavior: 'smooth' });
                document.getElementById('pantalla-inicio').style.display = 'none';
                document.getElementById('pantalla-certificacion').style.display = 'block';
                
                this.generarCertificado();
            },

            generarCertificado() {
                // Calcular puntuaci√≥n global
                const puntajeSimulaciones = (this.resultadosGlobales.simulaciones.aciertosDirectos / 
                                             this.resultadosGlobales.simulaciones.total) * 100;
                const puntajeCasosReales = (this.resultadosGlobales.casosReales.correctas / 
                                           this.resultadosGlobales.casosReales.total) * 100;
                const puntajeDesafios = this.resultadosGlobales.desafios.puntos;
                
                // Ponderaci√≥n: Simulaciones 40%, Casos Reales 30%, Desaf√≠os 30%
                const puntuacionGlobal = (puntajeSimulaciones * 0.4) + 
                                        (puntajeCasosReales * 0.3) + 
                                        (puntajeDesafios * 0.3);
                
                // Determinar nivel y estilo
                let nivel, emoji, claseNivel, mensaje, color;
                
                if (puntuacionGlobal >= 90) {
                    nivel = 'MAESTRO OHM-VENGER';
                    emoji = 'üèÜ';
                    claseNivel = 'maestro';
                    mensaje = 'Has alcanzado el nivel m√°s alto de dominio de la Ley de Ohm. Tu conocimiento y habilidad son excepcionales.';
                    color = '#ffd700';
                } else if (puntuacionGlobal >= 75) {
                    nivel = 'EXPERTO EL√âCTRICO';
                    emoji = '‚≠ê';
                    claseNivel = 'experto';
                    mensaje = 'Demuestras un dominio avanzado de los conceptos el√©ctricos y aplicaci√≥n pr√°ctica sobresaliente.';
                    color = '#667eea';
                } else if (puntuacionGlobal >= 60) {
                    nivel = 'T√âCNICO AVANZADO';
                    emoji = 'üí™';
                    claseNivel = 'avanzado';
                    mensaje = 'Posees conocimientos s√≥lidos y capacidad para resolver problemas el√©ctricos complejos.';
                    color = '#84fab0';
                } else if (puntuacionGlobal >= 45) {
                    nivel = 'T√âCNICO EN FORMACI√ìN';
                    emoji = 'üìö';
                    claseNivel = 'formacion';
                    mensaje = 'Muestras comprensi√≥n de conceptos fundamentales y est√°s en proceso de perfeccionar tus habilidades.';
                    color = '#a8edea';
                } else {
                    nivel = 'APRENDIZ';
                    emoji = 'üå±';
                    claseNivel = 'aprendiz';
                    mensaje = 'Has iniciado tu camino en el dominio de la electricidad. Sigue practicando para mejorar.';
                    color = '#ffecd2';
                }
                
                // Obtener fecha actual
                const fecha = new Date();
                const opciones = { year: 'numeric', month: 'long', day: 'numeric' };
                const fechaFormateada = fecha.toLocaleDateString('es-CO', opciones);
                
                // Generar certificado
                const contenedor = document.getElementById('certificacion-contenedor');
                contenedor.innerHTML = `
                    <div class="certificado">
                        <div class="certificado-titulo">
                            CERTIFICADO DE COMPETENCIA
                        </div>
                        <div class="certificado-subtitulo">
                            Ohm-Vengers: La Resistencia del Conocimiento
                        </div>
                        
                        <p style="font-size: 1.2em; color: #666; margin: 20px 0;">
                            Se certifica que el estudiante
                        </p>
                        
                        <div class="certificado-nombre">
                            ESTUDIANTE OHM-VENGER
                        </div>
                        
                        <p style="font-size: 1.1em; color: #666; margin: 20px 0;">
                            Ha completado satisfactoriamente todos los m√≥dulos del programa educativo 
                            sobre la Ley de Ohm y sus aplicaciones pr√°cticas, alcanzando el nivel de:
                        </p>
                        
                        <div class="certificado-nivel ${claseNivel}">
                            ${emoji} ${nivel} ${emoji}
                        </div>
                        
                        <p style="color: #666; font-size: 1.1em; line-height: 1.8; margin: 20px 0; text-align: center;">
                            ${mensaje}
                        </p>
                        
                        <div class="certificado-estadisticas">
                            <div class="certificado-stat">
                                <div class="certificado-stat-valor">${puntuacionGlobal.toFixed(1)}%</div>
                                <div class="certificado-stat-label">Puntuaci√≥n Global</div>
                            </div>
                            <div class="certificado-stat">
                                <div class="certificado-stat-valor">${this.resultadosGlobales.simulaciones.aciertosDirectos}/${this.resultadosGlobales.simulaciones.total}</div>
                                <div class="certificado-stat-label">Simulaciones al Primer Intento</div>
                            </div>
                            <div class="certificado-stat">
                                <div class="certificado-stat-valor">${this.resultadosGlobales.casosReales.correctas}/${this.resultadosGlobales.casosReales.total}</div>
                                <div class="certificado-stat-label">Casos Reales Correctos</div>
                            </div>
                            <div class="certificado-stat">
                                <div class="certificado-stat-valor">${this.resultadosGlobales.desafios.puntos}</div>
                                <div class="certificado-stat-label">Puntos en Desaf√≠os</div>
                            </div>
                        </div>
                        
                        <div class="certificado-fecha">
                            Pitalito, Atl√°ntico, Colombia<br>
                            ${fechaFormateada}
                        </div>
                        
                        <div class="certificado-firma">
                            <strong>I.E.T.I. Nuestra Se√±ora del Rosario</strong><br>
                            √Årea de Electr√≥nica - Grado 10¬∞
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 40px;">
                        <button onclick="juego.descargarCertificado()">üì• Descargar Certificado (Captura)</button>
                        <button class="secondary" onclick="juego.reiniciarProgreso()">üîÑ Reiniciar Todo el Progreso</button>
                    </div>
                    
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-top: 30px; text-align: center;">
                        <h3 style="color: #667eea; margin-bottom: 15px;">üéâ ¬°Felicitaciones!</h3>
                        <p style="color: #666; line-height: 1.8;">
                            Has demostrado compromiso y dedicaci√≥n en tu aprendizaje de la Ley de Ohm. 
                            Este certificado reconoce tus logros en los m√≥dulos de simulaci√≥n, casos reales 
                            y desaf√≠os cronometrados. Contin√∫a practicando para seguir mejorando tus habilidades 
                            en electr√≥nica.
                        </p>
                    </div>
                `;
            },

            descargarCertificado() {
                alert('üí° Consejo para descargar:\n\n1. Haz clic derecho sobre el certificado\n2. Selecciona "Guardar imagen como..."\n\nO usa la herramienta de captura de pantalla de tu dispositivo para guardar el certificado completo.');
            },

            reiniciarProgreso() {
                if (confirm('‚ö†Ô∏è ¬øEst√°s seguro?\n\nEsto borrar√° todo tu progreso y deber√°s completar todos los m√≥dulos nuevamente para obtener un nuevo certificado.')) {
                    // Reiniciar todos los datos
                    this.modulosCompletados = {
                        simulaciones: false,
                        casosReales: false,
                        desafios: false
                    };
                    this.resultadosGlobales = {
                        simulaciones: { completadas: 0, total: 5, aciertosDirectos: 0 },
                        casosReales: { correctas: 0, total: 5 },
                        desafios: { puntos: 0, maximo: 100 }
                    };
                    
                    alert('‚úÖ Progreso reiniciado\n\n¬°Puedes comenzar de nuevo todos los m√≥dulos!');
                    this.volverInicio();
                }
            }
        };

        window.onload = function() {
            console.log('Ohm-Vengers: La Resistencia del Conocimiento - Cargado correctamente');
        };
    </script>
</body>
</html>
